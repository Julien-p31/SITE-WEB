<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BILLU - Services</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        
        body {
            font-family: 'Orbitron', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f5f5f5, #dcdcdc); /* Dégradé de fond */
            color: black;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        header, footer {
            text-align: center;
            font-size: 1em;
            padding: 8px;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            color: white;
            width: 100%;
        }

        nav {
            display: flex;
            justify-content: center;
            gap: 15px;
            padding: 15px 0; /* Augmente la marge pour descendre le menu */
            margin-top: 10px; /* Ajout pour descendre le menu */
        }

	nav a.active,
        nav a:hover {
            transform: scale(1.1);
            background: rgba(0, 0, 0, 0.4);
            color: white;
}

        nav a {
            color: black;
            text-decoration: none;
            padding: 6px 12px;
            border-radius: 50px;
            background: rgba(0, 0, 0, 0.2);
            transition: transform 0.15s ease-out, background 0.15s ease-out; /* Transition plus rapide */
            font-size: 0.9em;
        }

        nav a:hover {
            transform: scale(1.1);
            background: rgba(0, 0, 0, 0.4);
            color: white;
        }

        .center-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            width: 100%;
            margin-top: -30px;
        }

        .services-container {
            display: flex;
            flex-direction: column; /* Aligne les lignes de cartes verticalement */
            gap: 50px;
            margin-top: 20px;
            width: 100%; /* Assurez-vous que la largeur est 100% pour bien occuper l'espace */
        }

        .row {
            display: flex;
            justify-content: center; /* Espace entre les cartes */
            gap: 50px; /* Espacement entre les cartes */
            width: 80%; /* Limiter la largeur de la ligne de cartes */
            margin: 0 auto; /* Centrer la ligne de cartes */
        }

        .icon-wrapper {
            text-align: center;
            width: 200px; /* Largeur fixe */
            height: 150px; /* Hauteur fixe */
            padding: 10px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            position: relative;
            transition: transform 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
            justify-content: center; /* Centre le contenu verticalement */
            align-items: center; /* Centre le contenu horizontalement */
        }

        .icon-wrapper:hover {
            transform: scale(1.05); /* effet au survol */
        }

        .icon-wrapper img {
            width: 60px;
            height: 60px;
            margin-bottom: 10px;
        }

        /* Halo autour de la carte */
        .icon-wrapper.up {
            box-shadow: 0 0 15px 5px green; /* Halo vert pour service en ligne */
        }

        .icon-wrapper.down {
            box-shadow: 0 0 15px 5px red; /* Halo rouge pour service hors ligne */
        }

        .status-text {
            font-size: 0.8em;
            color: #333;
        }

        .status-text.up {
            color: green;
            font-weight: bold;
        }

        .status-text.down {
            color: red;
            font-weight: bold;
        }

        .timestamp {
            font-size: 0.7em;
            color: #888;
        }

        /* Styles pour les particules */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* Empêche d'interagir avec les particules */
            overflow: hidden;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            background-color: rgba(60, 60, 60, 0.6); /* Couleur jaune plus voyante */
            opacity: 0.6; /* Particules opaques */
            animation: particle-animation 2s infinite; /* Animation plus rapide */
        }

        @keyframes particle-animation {
            0% {
                transform: scale(0) translateX(0) translateY(0);
                opacity: 1;
            }
            100% {
                transform: scale(1) translateX(var(--x)) translateY(var(--y));
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <header>
        BILLU
    </header>
    <nav>
        <a href="index.html">Accueil</a>
        <a href="services.html">Services</a>
        <a href="plan.html">Plan</a>
        <a href="github.html">GitHub</a>
        <a href="apropos.html">À propos</a>
        <a href="http://web.billu.com:5000">Assistance</a>
    </nav>

    <div class="center-content">
        <div class="services-container" id="services-container">
            <!-- 5 cartes du haut -->
            <div class="row" id="top-row">
                <!-- Les services seront ajoutés ici par JavaScript -->
            </div>
            <!-- 5 cartes du bas -->
            <div class="row" id="bottom-row">
                <!-- Les services seront ajoutés ici par JavaScript -->
            </div>
        </div>
    </div>

    <footer>
        &copy; 2025 BILLU - Tous droits réservés
    </footer>

    <div class="particles" id="particles"></div>

    <script>
        const services = [
            { name: 'pfSense', url: 'http://192.168.10.254/', img: 'https://wpcomputersolutions.com/wp-content/uploads/2018/07/pfsense-logo-e1534531558807.png' },
            { name: 'GLPI', url: 'http://glpi.billu.com/glpi/', img: 'https://glpi-project.org/wp-content/uploads/2021/06/logo-glpi-bleu-1.png' },
            { name: 'Passbolt', url: 'http://passbolt.billu.com/', img: 'https://static.cdnlogo.com/logos/p/97/passbolt.svg' },
            { name: 'Graylog', url: 'http://graylog.billu.com:9000/', img: 'https://static.cdnlogo.com/logos/g/32/graylog.svg' },
            { name: 'FreePBX', url: 'http://freepbx.billu.com/', img: 'https://cp.beget.com/shared/xisQQW8k-g5QWd77x9XCtcysQ5hIWg3I/logo_freepbx2x.png' },
            { name: 'iRedMail', url: 'https://mail.billu.com/mail/', img: 'https://www.iredmail.org/images/logo.png' },
            { name: 'Zabbix', url: 'http://zabbix.billu.com:8080/', img: 'https://ssd-disclosure.com/wp-content/uploads/2022/11/1_vloEha9mTCLM_SEnXdIUIw-300x300.png' },
            { name: 'Guacamole', url: 'http://bastion.billu.com:8080/guacamole/#/', img: 'https://d7umqicpi7263.cloudfront.net/img/product/030b6dbb-cd7b-486d-af34-99d4924864a1.com/6fb7788920aacfd15ab8e000e0f750a3' },
            { name: 'GitHub', url: 'https://github.com/WildCodeSchool/TSSR-2409-VERT-P3-G1-build-your-infra', img: 'https://static.cdnlogo.com/logos/g/69/github-icon.svg' },
            { name: 'Mailo', url: 'https://www.mailo.com/', img: './pictures/Mailo_logo.png' }
        ];

        function createServiceCard(service) {
            return `
                <div class="icon-wrapper" data-service="${service.url}">
                    <a href="${service.url}" target="_blank">
                        <img class="icon" src="${service.img}" alt="${service.name}">
                    </a>
                    <div class="service-name">${service.name}</div>
                    <div class="status-text">Vérification en cours...</div>
                    <div class="timestamp"></div>
                </div>
            `;
        }

        async function checkServiceStatus(url) {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 5000); // timeout 5 sec

            try {
                const response = await fetch(url, {
                    method: 'HEAD',
                    mode: 'no-cors',
                    signal: controller.signal
                });
                clearTimeout(timeoutId);
                return response.ok || response.type === 'opaque';  // 'opaque' is needed for CORS requests
            } catch (error) {
                clearTimeout(timeoutId);
                if (error.name === 'AbortError') {
                    console.log(`Timeout for ${url}`);
                }
                return false;  // Si une erreur ou timeout, le service est hors ligne
            }
        }

        async function updateServiceStatus() {
            const timestamp = new Date().toLocaleString();
            for (let i = 0; i < services.length; i++) {
                const service = services[i];
                const status = await checkServiceStatus(service.url);
                const statusElement = document.querySelectorAll('.icon-wrapper')[i];
                const statusTextElement = statusElement.querySelector('.status-text');
                const timestampElement = statusElement.querySelector('.timestamp');

                // Met à jour l'état de la carte
                if (status) {
                    statusElement.classList.add('up');
                    statusElement.classList.remove('down');
                    statusTextElement.classList.add('up');
                    statusTextElement.classList.remove('down');
                    statusTextElement.textContent = 'ON';
                } else {
                    statusElement.classList.add('down');
                    statusElement.classList.remove('up');
                    statusTextElement.classList.add('down');
                    statusTextElement.classList.remove('up');
                    statusTextElement.textContent = 'OFF';
                }

                // Affiche la date et l'heure de la vérification
                timestampElement.textContent = `${timestamp}`;
            }
        }

        function displayServices() {
            const topRow = document.getElementById("top-row");
            const bottomRow = document.getElementById("bottom-row");

            for (let i = 0; i < 5; i++) {
                topRow.innerHTML += createServiceCard(services[i]);
            }
            for (let i = 5; i < 10; i++) {
                bottomRow.innerHTML += createServiceCard(services[i]);
            }
        }

        displayServices();
        updateServiceStatus();  // Vérification initiale
        setInterval(updateServiceStatus, 5000);  // Vérification toutes les 5 secondes

        // Ajout des particules
        function createParticle() {
            const particle = document.createElement('div');
            particle.classList.add('particle');
            const size = Math.random() * 10 + 5;  // Taille plus petite
            particle.style.width = size + 'px';
            particle.style.height = size + 'px';
            particle.style.left = Math.random() * window.innerWidth + 'px';
            particle.style.top = Math.random() * window.innerHeight + 'px';
            particle.style.setProperty('--x', (Math.random() - 0.5) * 300 + 'px');  // Mouvement plus grand
            particle.style.setProperty('--y', (Math.random() - 0.5) * 300 + 'px');
            document.getElementById('particles').appendChild(particle);

            setTimeout(() => {
                particle.remove();
            }, 3000); // La particule disparaît après 3 secondes
        }

        setInterval(createParticle, 100); // Crée des particules toutes les 100ms
 
	document.addEventListener("DOMContentLoaded", function () {
                let currentPage = window.location.pathname.split("/").pop();
                let links = document.querySelectorAll("nav a");

                links.forEach(link => {
                        let linkPage = link.getAttribute("href");
                        if (linkPage === currentPage) {
                                link.classList.add("active");
                        }
                });
        });

   </script>
</body>
</html>

